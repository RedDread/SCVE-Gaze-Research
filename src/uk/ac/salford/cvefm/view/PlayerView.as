package uk.ac.salford.cvefm.view 
{
	import fl.motion.MatrixTransformer;
	import flash.display.MovieClip;
	import flash.display.Sprite;
	import flash.events.Event;
	import flash.events.MouseEvent;
	import flash.geom.Matrix;
	import flashandmath.as3.cards.PlayingCard;
	import uk.ac.salford.cvefm.controller.PokerDataController;
	import uk.ac.salford.cvefm.model.CardData;
	import uk.ac.salford.cvefm.model.PlayerData;

	
	/**
	 * ...
	 * @author Claire Miller
	 */
	public class PlayerView extends MovieClip 
	{
		public static const PLAYER_BET:String = "PlayerView_PlayerBet";
		
		private var _data:PokerDataController; 
		
		private var _firstCard:PlayingCard;
		private var _secondCard:PlayingCard;
		private var _button:PlaceBetButton;
		private var _playerId:Number;
		
		public function PlayerView (index:Number) 
		{
			super();
			
			_data = PokerDataController.getInstance ();
			
			var playerData:PlayerData = _data.getPlayerData (index);
			
			var matrix:Matrix = this.transform.matrix;
			matrix.rotate(playerData.rotation * Math.PI / 180);
			matrix.translate(playerData.x, playerData.y);
			
			this.transform.matrix = matrix;
			
			_button = new PlaceBetButton ();
			_button.x = 50;
			_button.y = 50;
			
			_button.addEventListener (MouseEvent.CLICK, onPlayerBet, false, 0, true); 
			
			addChild (_button);
		}
		
		public function enable () :void
		{
			_button.enabled = true;
		}
		
		public function disable () :void
		{
			_button.enabled = false;
		}

		public function dealTwoCards () :void
		{
			var deck:CardData = _data.getCardData ();
			
			_firstCard = deck.getNextCard ();
			_firstCard.x = 100
			this.addChild (_firstCard);
			
			_secondCard = deck.getNextCard ();
			_secondCard.x = 250;
			this.addChild (_secondCard);
		}
		
		private function onPlayerBet (event:MouseEvent) :void
		{
			dispatchEvent (new Event (PLAYER_BET, false));
		}
		
	}

}